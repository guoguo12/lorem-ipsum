/** https://github.com/guoguo12/lorem-ipsum */

function onOpen(){DocumentApp.getUi().createAddonMenu().addItem("Insert placeholder text...","showGenerateDialog").addToUi()}function onInstall(){onOpen()}function showGenerateDialog(){var e=PropertiesService.getDocumentProperties();var t=e.getProperty("last-used-num");var n=e.getProperty("last-used-units");var r=HtmlService.createTemplateFromFile("generate");r.num=t?t:"2";r.units=n?n:"words";var i=r.evaluate();i.setHeight(80);i.setWidth(290);DocumentApp.getUi().showModelessDialog(i,"Insert placeholder text")}function insertText(e){var t=PropertiesService.getDocumentProperties();t.setProperty("last-used-num",e.count);t.setProperty("last-used-units",e.units);var n=generator(e);DocumentApp.getActiveDocument().getCursor().insertText(n)}function simplePluralize(e){if(e.indexOf("s",e.length-1)===-1){return e+"s"}return e}var generator=function(){var e=arguments.length?arguments[0]:{},t=e.count||1,n=e.units||"sentences",r=e.sentenceLowerBound||5,i=e.sentenceUpperBound||15,s=e.paragraphLowerBound||3,o=e.paragraphUpperBound||7,u=e.format||"plain",a=e.words||dictionary.words,f=e.random||Math.random;n=simplePluralize(n.toLowerCase());var l=function(e,t){return Math.floor(f()*(t-e+1)+e)};var c=function(e){return e[l(0,e.length-1)]};var h=function(e,t,n){var r="",i={min:0,max:l(t,n)};while(i.min<i.max){r=r+" "+c(e);i.min=i.min+1}if(r.length){r=r.slice(1);r=r.charAt(0).toUpperCase()+r.slice(1)}return r};var p=function(e,t,n,r,i){var s="",o={min:0,max:l(t,n)};while(o.min<o.max){s=s+". "+h(e,r,i);o.min=o.min+1}if(s.length){s=s.slice(2);s=s+"."}return s};var d=0,v={min:0,max:t},m="",g="",y="\r\n";if(u=="html"){g="<p>";y="</p>"}while(v.min<v.max){switch(n.toLowerCase()){case"words":m=m+" "+c(a);break;case"sentences":m=m+". "+h(a,r,i);break;case"paragraphs":m=m+g+p(a,s,o,r,i)+y;break}v.min=v.min+1}if(m.length){var b=0;if(m.indexOf(". ")==0){b=2}else if(m.indexOf(".")==0||m.indexOf(" ")==0){b=1}m=m.slice(b);if(n=="sentences"){m=m+"."}}return m};var dictionary={words:["ad","adipisicing","aliqua","aliquip","amet","anim","aute","cillum","commodo","consectetur","consequat","culpa","cupidatat","deserunt","do","dolor","dolore","duis","ea","eiusmod","elit","enim","esse","est","et","eu","ex","excepteur","exercitation","fugiat","id","in","incididunt","ipsum","irure","labore","laboris","laborum","Lorem","magna","minim","mollit","nisi","non","nostrud","nulla","occaecat","officia","pariatur","proident","qui","quis","reprehenderit","sint","sit","sunt","tempor","ullamco","ut","velit","veniam","voluptate"]}